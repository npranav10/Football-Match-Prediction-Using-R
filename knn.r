library(class)
dataset = read.csv("D:/SEMESTER V/B1_ECM2002/J/Football-Data-Analysis-and-Prediction-master/Football-Data-Analysis-and-Prediction-master/Datasets/final_dataset.csv")
test = read.csv("D:/SEMESTER V/B1_ECM2002/J/Football-Data-Analysis-and-Prediction-master/Football-Data-Analysis-and-Prediction-master/Datasets/test.csv")
attach(dataset)
#train.X=cbind(HomeTeam, AwayTeam ,DiffPts,DiffLP,DiffFormPts)
library(clusterSim)
dataset = data.frame(lapply(dataset, function(x) as.numeric(x)))
dataset = data.Normalization (dataset,type="n4",normalization="column")
# 
test = data.frame(lapply(test, function(x) as.numeric(x)))
 test = data.Normalization (test,type="n4",normalization="column")
train.X=cbind(dataset[])

attach(test)
test.X=cbind(test[])
#test.X=cbind(HomeTeam, AwayTeam ,DiffPts,DiffLP,DiffFormPts)
train.FTR=dataset[,7]
set.seed(1)
knn.pred=knn(train.X,test.X,train.FTR,k=1)
table(knn.pred,test[,7])
mean(knn.pred==test[,7])
knn.pred=knn(train.X,test.X,train.FTR,k=100)
mean(knn.pred==test[,7])
knn.pred=knn(train.X,test.X,train.FTR,k=200)
mean(knn.pred==test[,7])
knn.pred=knn(train.X,test.X,train.FTR,k=250)
mean(knn.pred==test[,7])
knn.pred=knn(train.X,test.X,train.FTR,k=300)
mean(knn.pred==test[,7])

